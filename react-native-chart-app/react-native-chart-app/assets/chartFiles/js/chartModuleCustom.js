/**
 * Created by dushani on 8/28/15.
 * All the Features out side from the chart core will goes here
 * (Functions Regarding chart container and UI of the module (Buttons, selections and etc.. ))
 */
var chartModule = (function(){

    var _initializeArr = [];
    var _chartManager;
    var chart;

    var _initModule = function (properties, container) {
        try {

            if ($.inArray(container, _initializeArr) >= 0) {
                return;
            }else{
                _initializeArr.push(container);
            }
            _chartManager = infChart.manager;
            chart =_chartManager.initChart(container, properties);

            _bindEvents(container);

        } catch (err) {
            infUtil.handleException(err);
        }
    };

    var _bindEvents = function(container){
        var ele = $('#' + container).parent().find('div#symbol_search_container');
        ele.find('#txtBaseSymbol').keypress(function(event){
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if(keycode == '13'){
                $('#reloadChart').click();
            }
        });

        ele.find('#reloadChart').click(function(){

            var symbolElem = ele.find('#txtBaseSymbol');
            var symbolDesc = ele.find('#txtBaseSymbolDesc').val();
            var dp = ele.find('#txtBaseSymbolDp').val();
            var symbolType = ele.find('#txtBaseSymbolType').val();

            var symbol = symbolElem.val();

            if(!symbol){
                symbolElem.addClass('error_input');
                return false;
            }

            symbolElem.removeClass('error_input');


            var chartTemp = _chartManager.getChart(container);
            chartTemp.setSymbol({symbol:symbol, symbolId:symbol, symbolDesc:symbolDesc, symbolType:symbolType, dp:dp}, true,true);
            infChart.manager.getChart(container).setSymbol({symbol:'IBEX35', symbolId:'ES0SI0000005_indices_55_df', symbolDesc:'IBEX35', symbolType:'IND', dp:1}, true,true);
        });

    };

    var _updateOrders = function(orders, isDisplayOnly){
        chart.updateOrders(orders, isDisplayOnly);
    };

    return {
        initModule:_initModule,
        updateOrders : _updateOrders
    };

})();


$(document).ready(function(){
    //keyCloakAdaptor.initAdaptor();
    window.logMode = "debug";

    //TODO Added chart loading delay for first time to avoid first time chart loading error. need to find a proper way to handle this

    var provider, symbol, desc, obj = {};

    setTimeout(function () {
        provider = getUrlParameter('provider');
        if(provider){
            switch (provider){
                case 'infinit':
                    obj.symbol = { symbol: 'ALVd', symbolId: 'ALVd.CHX', symbolDesc: 'Allianz', symbolType: 'EQU', dp: 3, currency: 'EUR'};
                    obj.dataProvider = {
                        type : 'infinit', source : 'SIX', url : '/rest/history/load?'
                    };
                    obj.toolbar = {
                        config: {
                            comparison: {
                                options: [
                                    {symbol: 'BMWd', symbolId: 'BMWd.CHX', symbolDesc: 'Bayerische Motoren Werke', symbolType: 'EQU', dp: 3, currency:'EUR' },
                                    {symbol: 'BARCl', symbolId: 'BARCl.CHX', symbolDesc: 'Barclays', symbolType: 'EQU', dp: 3, currency:'GBP' },
                                    {symbol: 'BAYNd', symbolId: 'BAYNd.CHX', symbolDesc: 'Bayer', symbolType: 'EQU', dp: 3, currency:'EUR' },
                                    {symbol: 'ALVd', symbolId: 'ALVd.CHX', symbolDesc: 'Allianz', symbolType: 'EQU', dp: 3, currency:'EUR' }
                                ]
                            }
                        }
                    };
                    break;
                case 'webfg' : {
                    obj.dataProvider = {
                        type: 'WEBFG', source: 'WEBFG', url: '/x-one-webfg/dataService/dataRequest?'
                    };

                    obj.symbol = {symbol: 'DAX',
                        symbolId: 'DE0008469008_indices_22_df',
                        symbolDesc: 'DAX',
                        symbolType: 'IND',
                        dp: 3};

                    obj.toolbar = {
                        config: {
                            comparison: {
                                options: [
                                    {
                                        symbol: 'FTSE 100',
                                        symbolId: 'GB0001383545_indices_232_df',
                                        symbolDesc: 'FTSE 100',
                                        symbolType: 'IND',
                                        dp: 3
                                    },
                                    {
                                        symbol: 'NDX',
                                        symbolId: 'US6311011026_indices_67_df',
                                        symbolDesc: 'NASDAQ 100',
                                        symbolType: 'IND',
                                        dp: 3
                                    },
                                    {
                                        symbol: 'DAX',
                                        symbolId: 'DE0008469008_indices_22_df',
                                        symbolDesc: 'DAX',
                                        symbolType: 'IND',
                                        dp: 3
                                    },
                                    {
                                        symbol: 'SP500',
                                        symbolId: 'US78378X1072_indices_152_df',
                                        symbolDesc: 'S&P 500',
                                        symbolType: 'IND',
                                        dp: 3
                                    }
                                ]
                            }
                        }
                    };
                }
                default :
                    break;
            }
        }
        symbol = getUrlParameter('symbol');
        if(symbol){
            desc = getUrlParameter('sname');
            if(typeof desc === 'undefined'){
                desc = symbol;
            }

            var symboltype = getUrlParameter('stype');
            if(typeof symboltype === 'undefined'){
                symboltype = 'EQU';
            }
            var currency = getUrlParameter('currency');
            if(typeof currency === 'undefined'){
                currency = 'EUR';
            }
            var source = getUrlParameter('source');
            if(typeof source === 'undefined'){
                source = 'SIX';
            }

            obj.symbol = {
                symbol: desc, symbolId: symbol, symbolDesc: desc, symbolType: symboltype, dp: 2, currency : currency, provider : source

            }
        }
        var minYDP = getUrlParameter('minydp');
        /*obj.symbol.data = "BEGINDATA DE0008469008_indices_22_df_selfbankef31f930b8be01c1ee73c439576434ed DAILY 371\n2016-04-08-12-00;9576.40;9675.03;9572.57;9622.26;;0;\n 2016-04-11-12-00;9595.56;9751.93;9524.66;9682.99;;0;\n 2016-04-12-12-00;9716.75;9770.47;9617.83;9761.47;;0;\n 2016-04-13-12-00;9901.13;10026.10;9893.42;10026.10;;0;\n 2016-04-14-12-00;10042.28;10098.44;10016.17;10093.65;;0;\n 2016-04-15-12-00;10063.89;10070.04;10020.34;10051.57;;0;\n 2016-04-18-12-00;9933.70;10147.85;9920.90;10120.31;;0;\n 2016-04-19-12-00;10170.18;10370.80;10150.67;10349.59;;0;\n 2016-04-20-12-00;10312.64;10440.13;10304.14;10421.29;;0;\n 2016-04-21-12-00;10456.99;10474.38;10341.97;10435.73;;0;\n 2016-04-22-12-00;10377.22;10422.86;10324.83;10373.49;;0;\n 2016-04-25-12-00;10379.16;10399.30;10233.42;10294.35;;0;\n 2016-04-26-12-00;10359.77;10385.23;10213.55;10259.59;;0;\n 2016-04-27-12-00;10283.10;10323.25;10220.57;10299.83;;0;\n 2016-04-28-12-00;10222.11;10331.93;10125.52;10321.15;;0;\n 2016-04-29-12-00;10235.47;10252.08;10038.97;10038.97;;0;\n 2016-05-02-12-00;10091.17;10153.90;10066.34;10123.27;;0;\n 2016-05-03-12-00;10052.55;10061.95;9918.43;9926.77;;0;\n 2016-05-04-12-00;9925.25;9959.42;9812.73;9828.25;;0;\n 2016-05-05-12-00;9849.70;9921.37;9805.55;9851.86;;0;\n 2016-05-06-12-00;9805.39;9917.63;9737.00;9869.95;;0;\n 2016-05-09-12-00;9929.19;10068.53;9878.71;9980.49;;0;\n 2016-05-10-12-00;10057.53;10106.93;9994.58;10045.44;;0;\n 2016-05-11-12-00;10055.40;10055.70;9950.11;9975.32;;0;\n 2016-05-12-12-00;9899.90;10078.19;9838.12;9862.12;;0;\n 2016-05-13-12-00;9794.83;9979.93;9767.94;9952.90;;0;\n 2016-05-17-12-00;10016.79;10080.31;9846.91;9890.19;;0;\n 2016-05-18-12-00;9828.05;9946.27;9811.86;9943.23;;0;\n 2016-05-19-12-00;9847.64;9899.86;9773.72;9795.89;;0;\n 2016-05-20-12-00;9878.49;9921.59;9852.71;9916.02;;0;\n 2016-05-23-12-00;9891.38;9971.74;9811.74;9842.29;;0;\n 2016-05-24-12-00;9798.94;10077.65;9773.80;10057.31;;0;\n 2016-05-25-12-00;10143.37;10233.06;10130.68;10205.21;;0;\n 2016-05-26-12-00;10213.87;10286.23;10207.09;10272.71;;0;\n 2016-05-27-12-00;10257.91;10298.76;10241.98;10286.31;;0;\n 2016-05-30-12-00;10293.43;10338.41;10286.33;10333.23;;0;\n 2016-05-31-12-00;10356.14;10365.24;10243.22;10262.74;;0;\n 2016-06-01-12-00;10242.78;10283.82;10160.24;10204.44;;0;\n 2016-06-02-12-00;10199.20;10241.75;10156.86;10208.00;;0;\n 2016-06-03-12-00;10237.58;10282.72;10040.87;10103.26;;0;\n 2016-06-06-12-00;10105.09;10148.96;10092.86;10121.08;;0;\n 2016-06-07-12-00;10196.17;10312.53;10183.19;10287.68;;0;\n 2016-06-08-12-00;10246.49;10266.37;10177.44;10217.03;;0;\n 2016-06-09-12-00;10184.48;10187.07;10050.03;10088.87;;0;\n 2016-06-10-12-00;10024.69;10026.49;9819.12;9834.62;;0;\n 2016-06-13-12-00;9715.78;9755.23;9657.44;9657.44;;0;\n 2016-06-14-12-00;9595.17;9620.84;9507.51;9519.20;;0;\n 2016-06-15-12-00;9589.47;9665.21;9567.15;9606.71;;0;\n 2016-06-16-12-00;9480.43;9582.38;9432.87;9550.47;;0;\n 2016-06-17-12-00;9620.92;9705.29;9578.15;9631.36;;0;\n 2016-06-20-12-00;9850.59;9996.56;9850.59;9962.02;;0;\n 2016-06-21-12-00;9943.84;10051.07;9930.10;10015.54;;0;\n 2016-06-22-12-00;10084.74;10149.81;10043.68;10071.06;;0;\n 2016-06-23-12-00;10122.47;10340.84;10104.92;10257.03;;0;\n 2016-06-24-12-00;9237.62;9720.12;9226.15;9557.16;;0;\n 2016-06-27-12-00;9516.92;9589.28;9214.10;9268.66;;0;\n 2016-06-28-12-00;9458.38;9554.41;9419.38;9447.28;;0;\n 2016-06-29-12-00;9557.69;9640.39;9506.29;9612.27;;0;\n 2016-06-30-12-00;9566.07;9695.59;9513.52;9680.09;;0;\n 2016-07-01-12-00;9742.84;9806.47;9657.63;9776.12;;0;\n 2016-07-04-12-00;9797.66;9808.99;9701.15;9709.09;;0;\n 2016-07-05-12-00;9656.05;9659.41;9506.84;9532.61;;0;\n 2016-07-06-12-00;9449.57;9530.59;9304.01;9373.26;;0;\n 2016-07-07-12-00;9437.47;9507.91;9399.69;9418.78;;0;\n 2016-07-08-12-00;9392.20;9655.92;9389.05;9629.66;;0;\n 2016-07-11-12-00;9744.80;9841.86;9690.18;9833.41;;0;\n 2016-07-12-12-00;9850.40;10013.49;9841.11;9964.07;;0;\n 2016-07-13-12-00;9941.99;10001.87;9919.41;9930.71;;0;\n 2016-07-14-12-00;10058.49;10109.86;9984.55;10068.30;;0;\n 2016-07-15-12-00;10031.18;10098.75;9987.05;10066.90;;0;\n 2016-07-18-12-00;10079.03;10160.30;10011.84;10063.13;;0;\n 2016-07-19-12-00;10038.95;10050.77;9923.64;9981.24;;0;\n 2016-07-20-12-00;10054.54;10146.71;9991.65;10142.01;;0;\n 2016-07-21-12-00;10195.40;10195.65;10090.12;10156.21;;0;\n 2016-07-22-12-00;10130.51;10181.24;10073.28;10147.46;;0;\n 2016-07-25-12-00;10155.20;10264.06;10125.22;10198.24;;0;\n 2016-07-26-12-00;10199.66;10275.41;10150.00;10247.76;;0;\n 2016-07-27-12-00;10314.43;10352.32;10298.40;10319.55;;0;\n 2016-07-28-12-00;10309.92;10381.90;10264.39;10274.93;;0;\n 2016-07-29-12-00;10320.82;10355.31;10287.32;10337.50;;0;\n 2016-08-01-12-00;10426.36;10459.34;10277.37;10330.52;;0;\n 2016-08-02-12-00;10328.87;10330.64;10128.98;10144.34;;0;\n 2016-08-03-12-00;10150.13;10189.15;10092.53;10170.21;;0;\n 2016-08-04-12-00;10237.08;10282.17;10182.40;10227.86;;0;\n 2016-08-05-12-00;10242.88;10374.33;10216.64;10367.21;;0;\n 2016-08-08-12-00;10407.50;10478.75;10403.47;10432.36;;0;\n 2016-08-09-12-00;10438.60;10701.33;10433.79;10692.90;;0;\n 2016-08-10-12-00;10676.90;10708.25;10635.11;10650.89;;0;\n 2016-08-11-12-00;10687.57;10742.84;10635.42;10742.84;;0;\n 2016-08-12-12-00;10718.33;10735.11;10685.52;10713.43;;0;\n 2016-08-15-12-00;10719.14;10802.32;10712.13;10739.21;;0;\n 2016-08-16-12-00;10666.72;10737.07;10634.68;10676.65;;0;\n 2016-08-17-12-00;10694.55;10696.76;10516.05;10537.67;;0;\n 2016-08-18-12-00;10613.08;10625.33;10548.97;10603.03;;0;\n 2016-08-19-12-00;10613.23;10618.11;10490.96;10544.36;;0;\n 2016-08-22-12-00;10528.88;10656.25;10443.48;10494.35;;0;\n 2016-08-23-12-00;10542.95;10627.00;10516.27;10592.88;;0;\n 2016-08-24-12-00;10531.14;10653.17;10515.16;10622.97;;0;\n 2016-08-25-12-00;10576.56;10576.56;10470.73;10529.59;;0;\n 2016-08-26-12-00;10512.21;10613.06;10484.03;10587.77;;0;\n 2016-08-29-12-00;10503.88;10566.69;10441.81;10544.44;;0;\n 2016-08-30-12-00;10588.71;10688.48;10588.48;10657.64;;0;\n 2016-08-31-12-00;10627.18;10666.81;10591.44;10592.69;;0;\n 2016-09-01-12-00;10622.33;10676.32;10492.29;10534.31;;0;\n 2016-09-02-12-00;10570.70;10693.64;10516.81;10683.82;;0;\n 2016-09-05-12-00;10712.17;10740.39;10671.55;10672.22;;0;\n 2016-09-06-12-00;10704.89;10742.49;10657.43;10687.14;;0;\n 2016-09-07-12-00;10706.86;10775.93;10659.73;10752.98;;0;\n 2016-09-08-12-00;10749.82;10780.42;10570.06;10675.29;;0;\n 2016-09-09-12-00;10641.81;10671.66;10539.31;10573.44;;0;\n 2016-09-12-12-00;10380.46;10431.90;10299.38;10431.77;;0;\n 2016-09-13-12-00;10483.07;10507.04;10382.85;10386.60;;0;\n 2016-09-14-12-00;10410.30;10450.41;10369.72;10378.40;;0;\n 2016-09-15-12-00;10360.84;10446.40;10337.23;10431.20;;0;\n 2016-09-16-12-00;10403.67;10427.20;10262.19;10276.17;;0;\n 2016-09-19-12-00;10349.87;10381.93;10326.75;10373.87;;0;\n 2016-09-20-12-00;10374.68;10465.95;10371.62;10393.86;;0;\n 2016-09-21-12-00;10496.43;10535.25;10427.22;10436.49;;0;\n 2016-09-22-12-00;10518.53;10705.40;10517.80;10674.18;;0;\n 2016-09-23-12-00;10662.49;10675.62;10610.95;10626.97;;0;\n 2016-09-26-12-00;10555.19;10560.83;10385.63;10393.71;;0;\n 2016-09-27-12-00;10451.40;10455.88;10265.69;10361.48;;0;\n 2016-09-28-12-00;10425.89;10518.36;10417.15;10438.34;;0;\n 2016-09-29-12-00;10545.60;10575.34;10370.23;10405.54;;0;\n 2016-09-30-12-00;10240.69;10531.26;10189.94;10511.02;;0;\n 2016-10-04-12-00;10492.97;10646.72;10492.25;10619.61;;0;\n 2016-10-05-12-00;10535.62;10622.44;10486.63;10585.78;;0;\n 2016-10-06-12-00;10641.13;10641.13;10537.68;10568.80;;0;\n 2016-10-07-12-00;10549.69;10579.09;10465.35;10490.86;;0;\n 2016-10-10-12-00;10496.01;10639.41;10454.98;10624.08;;0;\n 2016-10-11-12-00;10600.94;10692.36;10568.72;10577.16;;0;\n 2016-10-12-12-00;10572.72;10604.00;10503.20;10523.07;;0;\n 2016-10-13-12-00;10425.79;10430.83;10349.06;10414.07;;0;\n 2016-10-14-12-00;10450.06;10615.30;10449.47;10580.38;;0;\n 2016-10-17-12-00;10544.69;10583.70;10491.28;10503.57;;0;\n 2016-10-18-12-00;10560.14;10657.34;10543.69;10631.55;;0;\n 2016-10-19-12-00;10626.99;10672.22;10587.71;10645.68;;0;\n 2016-10-20-12-00;10665.75;10748.41;10592.89;10701.39;;0;\n 2016-10-21-12-00;10710.51;10737.26;10672.35;10710.73;;0;\n 2016-10-24-12-00;10743.87;10820.08;10743.87;10761.17;;0;\n 2016-10-25-12-00;10786.25;10827.72;10738.36;10757.31;;0;\n 2016-10-26-12-00;10726.22;10737.79;10632.29;10709.68;;0;\n 2016-10-27-12-00;10691.86;10772.67;10656.18;10717.08;;0;\n 2016-10-28-12-00;10634.99;10716.16;10583.57;10696.19;;0;\n 2016-10-31-12-00;10658.67;10687.74;10634.34;10665.01;;0;\n 2016-11-01-12-00;10724.14;10730.48;10506.39;10526.16;;0;\n 2016-11-02-12-00;10443.52;10460.93;10368.20;10370.93;;0;\n 2016-11-03-12-00;10341.86;10406.72;10325.88;10325.88;;0;\n 2016-11-04-12-00;10281.87;10286.39;10212.53;10259.13;;0;\n 2016-11-07-12-00;10410.56;10456.95;10381.14;10456.95;;0;\n 2016-11-08-12-00;10449.52;10486.04;10414.83;10482.32;;0;\n 2016-11-09-12-00;10181.89;10646.55;10174.92;10646.01;;0;\n 2016-11-10-12-00;10710.04;10793.97;10575.96;10630.12;;0;\n 2016-11-11-12-00;10702.88;10714.47;10584.31;10667.95;;0;\n 2016-11-14-12-00;10750.62;10802.39;10677.09;10693.69;;0;\n 2016-11-15-12-00;10720.93;10748.31;10666.17;10735.14;;0;\n 2016-11-16-12-00;10726.34;10735.47;10610.27;10663.87;;0;\n 2016-11-17-12-00;10640.36;10686.88;10604.32;10685.54;;0;\n 2016-11-18-12-00;10735.05;10737.98;10649.12;10664.56;;0;\n 2016-11-21-12-00;10697.95;10727.09;10595.14;10685.13;;0;\n 2016-11-22-12-00;10745.67;10767.73;10707.87;10713.85;;0;\n 2016-11-23-12-00;10718.89;10742.66;10602.21;10662.44;;0;\n 2016-11-24-12-00;10689.16;10715.65;10653.62;10689.26;;0;\n 2016-11-25-12-00;10700.17;10710.16;10649.37;10699.27;;0;\n 2016-11-28-12-00;10655.92;10658.36;10554.94;10582.67;;0;\n 2016-11-29-12-00;10562.15;10624.76;10539.23;10620.49;;0;\n 2016-11-30-12-00;10615.79;10691.67;10606.04;10640.30;;0;\n 2016-12-01-12-00;10593.06;10627.10;10502.54;10534.05;;0;\n 2016-12-02-12-00;10436.48;10545.37;10402.59;10513.35;;0;\n 2016-12-05-12-00;10494.64;10730.74;10493.62;10684.83;;0;\n 2016-12-06-12-00;10685.00;10786.26;10668.67;10775.32;;0;\n 2016-12-07-12-00;10885.05;10988.79;10873.81;10986.69;;0;\n 2016-12-08-12-00;11035.76;11193.10;10990.60;11179.42;;0;\n 2016-12-09-12-00;11170.18;11231.69;11145.98;11203.63;;0;\n 2016-12-12-12-00;11198.42;11213.04;11141.86;11190.21;;0;\n 2016-12-13-12-00;11194.67;11300.44;11191.64;11284.65;;0;\n 2016-12-14-12-00;11254.47;11281.43;11235.24;11244.84;;0;\n 2016-12-15-12-00;11267.03;11387.11;11267.03;11366.40;;0;\n 2016-12-16-12-00;11368.64;11451.57;11357.15;11404.01;;0;\n 2016-12-19-12-00;11384.03;11426.70;11380.12;11426.70;;0;\n 2016-12-20-12-00;11415.30;11472.08;11406.95;11464.74;;0;\n 2016-12-21-12-00;11445.23;11479.88;11440.29;11468.64;;0;\n 2016-12-22-12-00;11444.41;11475.76;11428.77;11456.10;;0;\n 2016-12-23-12-00;11477.23;11480.18;11409.43;11449.93;;0;\n 2016-12-27-12-00;11457.91;11481.46;11451.55;11472.24;;0;\n 2016-12-28-12-00;11469.45;11475.89;11459.40;11474.99;;0;\n 2016-12-29-12-00;11411.36;11459.19;11404.82;11451.05;;0;\n 2016-12-30-12-00;11443.31;11481.66;11405.77;11481.06;;0;\n 2017-01-02-12-00;11426.38;11617.28;11414.82;11598.33;;0;\n 2017-01-03-12-00;11631.70;11637.37;11561.23;11584.24;;0;\n 2017-01-04-12-00;11609.53;11616.09;11531.43;11584.31;;0;\n 2017-01-05-12-00;11537.73;11602.54;11537.40;11584.94;;0;\n 2017-01-06-12-00;11560.52;11605.74;11547.05;11599.01;;0;\n 2017-01-09-12-00;11606.89;11606.89;11522.35;11563.99;;0;\n 2017-01-10-12-00;11583.24;11606.95;11544.99;11583.30;;0;\n 2017-01-11-12-00;11587.53;11692.27;11524.99;11646.17;;0;\n 2017-01-12-12-00;11599.24;11606.43;11491.87;11521.04;;0;\n 2017-01-13-12-00;11576.78;11635.55;11554.45;11629.18;;0;\n 2017-01-16-12-00;11537.45;11579.05;11535.96;11554.71;;0;\n 2017-01-17-12-00;11521.50;11583.43;11425.14;11540.00;;0;\n 2017-01-18-12-00;11592.12;11599.39;11529.76;11599.39;;0;\n 2017-01-19-12-00;11624.11;11644.88;11578.91;11596.89;;0;\n 2017-01-20-12-00;11568.90;11636.79;11547.04;11630.13;;0;\n 2017-01-23-12-00;11545.97;11605.29;11508.83;11545.75;;0;\n 2017-01-24-12-00;11554.80;11596.18;11538.05;11594.94;;0;\n 2017-01-25-12-00;11677.63;11827.73;11669.30;11806.05;;0;\n 2017-01-26-12-00;11867.91;11893.08;11819.76;11848.63;;0;\n 2017-01-27-12-00;11841.72;11844.68;11798.26;11814.27;;0;\n 2017-01-30-12-00;11786.31;11792.33;11659.35;11681.89;;0;\n 2017-01-31-12-00;11692.53;11733.16;11535.31;11535.31;;0;\n 2017-02-01-12-00;11646.42;11723.39;11622.60;11659.50;;0;\n 2017-02-02-12-00;11628.28;11675.98;11603.65;11627.95;;0;\n 2017-02-03-12-00;11636.23;11696.94;11627.98;11651.49;;0;\n 2017-02-06-12-00;11628.03;11679.91;11509.58;11509.84;;0;\n 2017-02-07-12-00;11498.49;11606.26;11483.83;11549.44;;0;\n 2017-02-08-12-00;11546.93;11591.26;11479.78;11543.38;;0;\n 2017-02-09-12-00;11584.40;11657.24;11548.18;11642.86;;0;\n 2017-02-10-12-00;11698.70;11711.55;11645.13;11666.97;;0;\n 2017-02-13-12-00;11697.99;11812.69;11684.91;11774.43;;0;\n 2017-02-14-12-00;11766.99;11787.82;11752.68;11771.81;;0;\n 2017-02-15-12-00;11834.48;11848.04;11725.38;11793.93;;0;\n 2017-02-16-12-00;11778.99;11814.70;11728.38;11757.24;;0;\n 2017-02-17-12-00;11759.57;11775.40;11693.70;11757.02;;0;\n 2017-02-20-12-00;11831.71;11841.06;11804.72;11827.62;;0;\n 2017-02-21-12-00;11817.97;11987.58;11798.48;11967.49;;0;\n 2017-02-22-12-00;11989.71;12031.11;11966.02;11998.59;;0;\n 2017-02-23-12-00;11994.06;12015.98;11925.88;11947.83;;0;\n 2017-02-24-12-00;11920.90;11934.64;11722.35;11804.03;;0;\n 2017-02-27-12-00;11858.14;11860.82;11792.51;11822.67;;0;\n 2017-02-28-12-00;11847.09;11853.50;11780.83;11834.41;;0;\n 2017-03-01-12-00;11915.03;12074.02;11913.84;12067.19;;0;\n 2017-03-02-12-00;12052.80;12082.59;12041.90;12059.57;;0;\n 2017-03-03-12-00;11998.06;12058.21;11995.40;12027.36;;0;\n 2017-03-06-12-00;11956.81;11998.83;11921.57;11958.40;;0;\n 2017-03-07-12-00;11963.76;11988.87;11935.33;11966.14;;0;\n 2017-03-08-12-00;11922.86;12017.28;11922.31;11967.31;;0;\n 2017-03-09-12-00;11923.51;12024.70;11917.78;11978.39;;0;\n 2017-03-10-12-00;12018.48;12067.07;11936.81;11963.18;;0;\n 2017-03-13-12-00;11954.80;12006.01;11949.03;11990.03;;0;\n 2017-03-14-12-00;11987.34;12002.75;11930.38;11988.79;;0;\n 2017-03-15-12-00;12000.44;12027.05;11977.32;12009.87;;0;\n 2017-03-16-12-00;12140.30;12156.44;12046.07;12083.18;;0;\n 2017-03-17-12-00;12039.24;12117.90;12018.27;12095.24;;0;\n 2017-03-20-12-00;12050.81;12082.31;12033.24;12052.90;;0;\n 2017-03-21-12-00;12083.01;12111.24;11938.42;11962.13;;0;\n 2017-03-22-12-00;11870.78;11934.35;11850.27;11904.12;;0;\n 2017-03-23-12-00;11914.20;12043.67;11896.68;12039.68;;0;\n 2017-03-24-12-00;12033.27;12082.67;12010.33;12064.27;;0;\n 2017-03-27-12-00;11957.65;11996.35;11916.07;11996.07;;0;\n 2017-03-28-12-00;12062.69;12158.72;12045.17;12149.42;;0;\n 2017-03-29-12-00;12195.86;12233.76;12180.83;12203.00;;0;\n 2017-03-30-12-00;12220.64;12258.37;12200.34;12256.43;;0;\n 2017-03-31-12-00;12241.57;12313.29;12230.17;12312.87;;0;\n 2017-04-03-12-00;12368.82;12375.58;12256.94;12257.20;;0;\n 2017-04-04-12-00;12255.72;12288.78;12225.38;12282.34;;0;\n 2017-04-05-12-00;12280.06;12293.13;12212.17;12217.54;;0;\n 2017-04-06-12-00;12147.37;12242.50;12119.04;12230.89;;0;\n 2017-04-07-12-00;12174.51;12225.06;12144.98;12225.06;;0;\n 2017-04-10-12-00;12244.50;12246.88;12178.10;12200.52;;0;\n 2017-04-11-12-00;12149.40;12221.43;12049.93;12139.35;;0;\n 2017-04-12-12-00;12174.96;12242.76;12123.12;12154.70;;0;\n 2017-04-13-12-00;12137.57;12147.70;12089.94;12109.00;;0;\n 2017-04-18-12-00;12135.61;12162.47;11996.74;12000.44;;0;\n 2017-04-19-12-00;12014.03;12040.23;12001.86;12016.45;;0;\n 2017-04-20-12-00;11968.06;12050.66;11941.57;12027.32;;0;\n 2017-04-21-12-00;12032.78;12091.33;12009.12;12048.57;;0;\n 2017-04-24-12-00;12296.56;12456.18;12289.37;12454.98;;0;\n 2017-04-25-12-00;12457.83;12482.90;12439.11;12467.04;;0;\n 2017-04-26-12-00;12466.50;12486.29;12442.37;12472.80;;0;\n 2017-04-27-12-00;12440.01;12478.28;12426.99;12443.79;;0;\n 2017-04-28-12-00;12417.89;12462.11;12414.10;12438.01;;0;\n 2017-05-02-12-00;12478.46;12511.17;12433.51;12507.90;;0;\n 2017-05-03-12-00;12502.36;12532.25;12477.87;12527.84;;0;\n 2017-05-04-12-00;12552.06;12648.22;12539.71;12647.78;;0;\n 2017-05-05-12-00;12601.46;12718.66;12591.75;12716.89;;0;\n 2017-05-08-12-00;12758.48;12762.04;12659.70;12694.55;;0;\n 2017-05-09-12-00;12732.74;12783.23;12703.96;12749.12;;0;\n 2017-05-10-12-00;12728.97;12776.08;12715.67;12757.46;;0;\n 2017-05-11-12-00;12767.13;12772.88;12662.49;12711.06;;0;\n 2017-05-12-12-00;12728.84;12771.00;12714.38;12770.41;;0;\n 2017-05-15-12-00;12824.05;12832.29;12729.49;12807.04;;0;\n 2017-05-16-12-00;12787.69;12841.66;12776.02;12804.53;;0;\n 2017-05-17-12-00;12700.12;12786.89;12587.45;12631.61;;0;\n 2017-05-18-12-00;12608.19;12634.26;12489.95;12590.06;;0;\n 2017-05-19-12-00;12612.30;12658.55;12596.72;12638.69;;0;\n 2017-05-22-12-00;12664.97;12670.26;12571.06;12619.46;;0;\n 2017-05-23-12-00;12597.54;12703.74;12593.33;12659.15;;0;\n 2017-05-24-12-00;12631.39;12662.05;12617.76;12642.87;;0;\n 2017-05-25-12-00;12693.84;12697.66;12543.77;12621.72;;0;\n 2017-05-26-12-00;12604.40;12611.49;12529.51;12602.18;;0;\n 2017-05-29-12-00;12588.80;12633.37;12578.58;12628.95;;0;\n 2017-05-30-12-00;12583.82;12648.10;12567.22;12598.68;;0;\n 2017-05-31-12-00;12612.52;12709.13;12582.80;12615.06;;0;\n 2017-06-01-12-00;12623.61;12677.60;12621.53;12664.92;;0;\n 2017-06-02-12-00;12735.00;12878.59;12734.78;12822.94;;0;\n 2017-06-06-12-00;12768.46;12788.34;12679.58;12690.12;;0;\n 2017-06-07-12-00;12659.97;12746.42;12640.52;12672.49;;0;\n 2017-06-08-12-00;12688.54;12740.36;12684.71;12713.58;;0;\n 2017-06-09-12-00;12711.53;12821.03;12711.53;12815.72;;0;\n 2017-06-12-12-00;12760.39;12782.73;12666.39;12690.44;;0;\n 2017-06-13-12-00;12739.50;12790.30;12727.83;12764.98;;0;\n 2017-06-14-12-00;12798.26;12921.17;12788.70;12805.95;;0;\n 2017-06-15-12-00;12801.91;12804.47;12620.90;12691.81;;0;\n 2017-06-16-12-00;12746.05;12762.35;12707.59;12752.73;;0;\n 2017-06-19-12-00;12849.99;12912.85;12833.01;12888.95;;0;\n 2017-06-20-12-00;12938.04;12951.54;12814.76;12814.79;;0;\n 2017-06-21-12-00;12792.32;12804.42;12708.99;12774.26;;0;\n 2017-06-22-12-00;12758.66;12806.02;12717.29;12794.00;;0;\n 2017-06-23-12-00;12757.97;12787.22;12677.40;12733.41;;0;\n 2017-06-26-12-00;12783.89;12841.31;12752.75;12770.83;;0;\n 2017-06-27-12-00;12728.50;12751.20;12644.95;12671.02;;0;\n 2017-06-28-12-00;12586.06;12671.28;12536.86;12647.27;;0;\n 2017-06-29-12-00;12707.48;12729.18;12396.13;12416.19;;0;\n 2017-06-30-12-00;12424.50;12459.69;12319.00;12325.12;;0;\n 2017-07-03-12-00;12396.34;12486.29;12390.73;12475.31;;0;\n 2017-07-04-12-00;12413.60;12481.81;12411.56;12437.13;;0;\n 2017-07-05-12-00;12432.41;12496.82;12406.69;12453.68;;0;\n 2017-07-06-12-00;12474.51;12490.72;12316.43;12381.25;;0;\n 2017-07-07-12-00;12376.19;12388.68;12339.91;12388.68;;0;\n 2017-07-10-12-00;12464.96;12482.95;12423.54;12429.45;;0;\n 2017-07-11-12-00;12479.67;12539.18;12417.85;12437.02;;0;\n 2017-07-12-12-00;12469.85;12648.19;12468.16;12626.58;;0;\n 2017-07-13-12-00;12614.13;12676.52;12613.52;12641.33;;0;\n 2017-07-14-12-00;12642.65;12662.01;12577.33;12631.72;;0;\n 2017-07-17-12-00;12652.37;12656.13;12542.96;12587.16;;0;\n 2017-07-18-12-00;12540.93;12572.86;12384.61;12430.39;;0;\n 2017-07-19-12-00;12468.06;12475.17;12418.67;12452.05;;0;\n 2017-07-20-12-00;12514.84;12575.52;12392.19;12447.25;;0;\n 2017-07-21-12-00;12424.80;12464.12;12190.89;12240.06;;0;\n 2017-07-24-12-00;12228.63;12235.85;12142.01;12208.95;;0;\n 2017-07-25-12-00;12228.32;12301.67;12211.14;12264.31;;0;\n 2017-07-26-12-00;12260.30;12341.03;12255.74;12305.11;;0;\n 2017-07-27-12-00;12230.09;12293.90;12176.02;12212.04;;0;\n 2017-07-28-12-00;12151.38;12183.77;12098.57;12162.70;;0;\n 2017-07-31-12-00;12141.53;12210.30;12097.36;12118.25;;0;\n 2017-08-01-12-00;12147.89;12302.38;12092.06;12251.29;;0;\n 2017-08-02-12-00;12269.90;12275.00;12153.54;12181.48;;0;\n 2017-08-03-12-00;12130.76;12184.60;12099.13;12154.72;;0;\n 2017-08-04-12-00;12138.09;12321.98;12123.66;12297.72;;0;\n 2017-08-07-12-00;12305.74;12336.00;12225.77;12257.17;;0;\n 2017-08-08-12-00;12239.78;12329.97;12184.59;12292.05;;0;\n 2017-08-09-12-00;12191.37;12227.52;12100.12;12154.00;;0;\n 2017-08-10-12-00;12158.69;12158.92;11993.73;12014.30;;0;\n 2017-08-11-12-00;11961.60;12046.89;11934.92;12014.06;;0;\n 2017-08-14-12-00;12100.17;12195.43;12097.00;12165.12;;0;\n 2017-08-15-12-00;12208.30;12234.64;12156.87;12177.04;;0;\n 2017-08-16-12-00;12250.02;12301.40;12240.83;12263.86;;0;\n 2017-08-17-12-00;12236.60;12290.05;12184.27;12203.46;;0;\n 2017-08-18-12-00;12103.51;12178.09;12080.74;12165.19;;0;\n 2017-08-21-12-00;12105.72;12149.58;12021.70;12065.99;;0;\n 2017-08-22-12-00;12151.76;12234.79;12124.15;12229.34;;0;\n 2017-08-23-12-00;12227.23;12269.92;12155.74;12174.30;;0;\n 2017-08-24-12-00;12196.18;12254.75;12169.54;12180.83;;0;\n 2017-08-25-12-00;12194.73;12249.44;12132.50;12167.94;;0;\n 2017-08-28-12-00;12105.49;12173.53;12064.36;12123.47;;0;\n 2017-08-29-12-00;12031.12;12032.32;11868.84;11945.88;;0;\n 2017-08-30-12-00;12026.45;12040.82;11989.61;12002.47;;0;\n 2017-08-31-12-00;12098.57;12115.55;12034.18;12055.84;;0;\n 2017-09-01-12-00;12101.15;12191.23;12085.31;12142.64;;0;\n 2017-09-04-12-00;12051.80;12138.41;12050.53;12102.21;;0;\n 2017-09-05-12-00;12125.42;12210.25;12100.26;12123.71;;0;\n 2017-09-06-12-00;12071.90;12260.76;12066.84;12214.54;;0;\n 2017-09-07-12-00;12284.14;12363.60;12265.51;12296.63;;0;\n 2017-09-08-12-00;12261.81;12321.61;12245.33;12303.98;;0;\n 2017-09-11-12-00;12381.52;12481.77;12381.33;12475.24;;0;\n 2017-09-12-12-00;12527.44;12558.03;12512.59;12524.77;;0;\n 2017-09-13-12-00;12489.25;12565.85;12489.25;12553.57;;0;\n 2017-09-14-12-00;12524.12;12552.16;12499.55;12540.45;;0;\n 2017-09-15-12-00;12525.36;12561.35;12506.94;12518.81;;0;\n 2017-09-18-12-00;12593.55;12613.56;12537.07;12559.39;;0;\n 2017-09-19-12-00;12556.46;12566.20;12527.90;12561.79;;0;" +
        "\n---packet end---";*/
        /*obj.config = {type: 'line'};*/
        obj.config = {
            lineDataField : 'open',
            period : 'C',
            range : {
                fromDate : '2017-03-08-12-00-00',
                toDate : '2017-09-19-12-00-00'
            }
        };
        obj.registeredMethods = {
            onBaseSymbolDataLoad : function(rangeData) {
                console.log('onBaseSymbolDataLoad');
            },
            onCompareSymbolLoad : function(rangeData) {
                console.log('onCompareSymbolLoad');
            },
            afterXSetExtremes : function() {
                console.log('afterXSetExtremes');
            }
        };

        if(typeof minYDP != "undefined") {
            obj.config.minYDecimalPlaces = minYDP;

        }

        chartModule.initModule({settings : obj, config:{yAxis : []}}, 'mainchart');
        //chartModule.updateOrders([
        //    {
        //        "userName": "testUser",
        //        "symbolName": "YAHOO",
        //        "symbolExchange": "NSDQ",
        //        "quantity": "100",
        //        "price": "34.2754",
        //        "orderSide": "BUY",
        //        "tifType": "DAY",
        //        "orderType": "Stop",
        //        "takeProfit": "0.06",
        //        "stopLoss": "0.04",
        //        "time": "2016-05-27T13:10:44.195Z",
        //        "status": "Submitted",
        //        "filedQuantity": "0",
        //        "orderId": "1464354644195"
        //    }, {
        //        "userName": "testUser",
        //        "symbolName": "YAHOO",
        //        "symbolExchange": "NSDQ",
        //        "quantity": "1000",
        //        "price": "38.6653",
        //        "orderSide": "SELL",
        //        "tifType": "DAY",
        //        "orderType": "Stop",
        //        "takeProfit": "0.02",
        //        "stopLoss": "0.02",
        //        "time": "2016-05-27T13:17:33.214Z",
        //        "status": "Submitted",
        //        "filedQuantity": "0",
        //        "orderId": "1464355053214"
        //    }, {
        //        "userName": "testUser",
        //        "symbolName": "YAHOO",
        //        "symbolExchange": "NSDQ",
        //        "quantity": "150",
        //        "price": "36.6653",
        //        "orderSide": "SELL",
        //        "tifType": "DAY",
        //        "orderType": "Stop",
        //        "takeProfit": "0.02",
        //        "stopLoss": "0.02",
        //        "time": "2016-04-20T13:17:33.214Z",
        //        "status": "Filled",
        //        "filedQuantity": "0",
        //        "orderId": "1464355953214"
        //    }
        //], true);
    }, 1000);

    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    };

    if(getUrlParameter("search") === 'true'){
        $("#symbol_search_container").show();
    }

    /*   $(window).resize( function() {
     $("#mainchart").data("infChart").resizeChart();
     });*/
});


